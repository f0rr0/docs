---
title: 'Prisma Migrate'
metaTitle: 'Prisma Migrate | Database, Schema, SQL Migration Tool'
metaDescription: 'Prisma Migrate is a database migration tool available via the Prisma CLI that integrates with Prisma schema for data modeling.'
tocDepth: 3
---

<TopBlock>

Prisma Migrate is an **imperative database schema migration tool** that enables you to:

* Keep your database schema in sync with your [Prisma schema](../prisma-schema) as it evolves
* Maintain existing data in your database

Prisma Migrate generates a history of `.sql` files, and plays a role in both [development](#development) and [deployment](#deployment).

> If you are at the schema prototyping stage, consider using the [`db push` command](#prisma-migrate-and-db-push).

</TopBlock>

## Getting started with Prisma Migrate

> See [Developing with Prisma Migrate]() <span class="guide"></span> for a more in-depth development workflow.

To get started with Prisma Migrate in a development environment:

1. Create a Prisma schema:

   ```prisma file=schema.prisma
   datasource db {
     provider = "postgresql"
     url      = env("DATABASE_URL")
   }

   model User {
     id    Int      @id @default(autoincrement())
     name  String
     posts Post[]
   }

   model Post {
     id        Int     @id @default(autoincrement())
     title     String
     published Boolean @default(true)
     authorId  Int
     author    User    @relation(fields: [authorId], references: [id])
   }
   ```

   > **Tip**: You can use [native type mapping attributes](type-mapping) in your schema to decide which exact database type to create (for example, `String` can map to `varchar(100)` or `text`).

1. Create the first migration:

    <CodeWithResult showText="Show migration SQL" hideText="Hide migration SQL">
    <Cmd>

    
    ```terminal
    prisma migrate dev --name init
    ```

    </Cmd>
    <CmdResult>

    ```sql
      -- CreateTable
    CREATE TABLE "User" (
    "id" SERIAL,
        "name" TEXT NOT NULL,

        PRIMARY KEY ("id")
    );
      -- CreateTable
    CREATE TABLE "Post" (
    "id" SERIAL,
        "title" TEXT NOT NULL,
        "published" BOOLEAN NOT NULL DEFAULT true,
        "authorId" INTEGER NOT NULL,

        PRIMARY KEY ("id")
    );

      -- AddForeignKey
    ALTER TABLE "Post" ADD FOREIGN KEY("authorId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE;
    ```

    </CmdResult>
    </CodeWithResult>

    Your Prisma schema is now in sync with your database schema and you have initialized a migration history.

1. Evolve your schema by introducing additional fields:

    ```prisma highlight=3;add
    model User {
      id       Int      @id @default(autoincrement())
      jobTitle String
      name     String
      posts    Post[]
    }
    ```
        
1. Create the second migration:

    <CodeWithResult showText="Show migration SQL" hideText="Hide migration SQL">
    <Cmd>

    ```terminal
    prisma migrate dev --name added_job_title
    ```

    </Cmd>
    <CmdResult>

    ```sql
      -- AlterTable
    ALTER TABLE "User" ADD COLUMN     "jobTitle" TEXT NOT NULL;
    ```

    </CmdResult>
    </CodeWithResult>

    Your Prisma schema is once again in sync with your database schema, and your migration history contains two migrations.

You now have a migration history that you can [source control](#team-development) and use to [deploy changes to test environments and production](#deployment).

## Prisma Migrate workflow

### Development

In a development environment, you should always use the following command to generate and apply migrations:

```terminal
npx prisma migrate dev
```

In the simplest case, it does the following:

1. Applies pending migrations
2. Generate a new migration based on the changes in the Prisma schema
3. Applies the new migration to the database and updates the `_prisma_migrations` table
4. Trigger the generation of artifacts (for example, the Prisma Client)

The `migrate dev` command will prompt you to reset the database in the following scenarios:

- Migration history conflicts caused by modified or missing migration
- The database schema has drifted away from the end-state of the migration history

When the database is reset, if Prisma Migrate detects a seed script, the database will be automatically seeded.

> **Note**: For a simple and integrated way to re-create data in your development database as often as needed, check out our [seeding guide](../../../guides/application-lifecycle/seed-database).

This command:

1. Replays the existing migration history in the [shadow database](shadow-database) to create a baseline
1. Applies unappplied migrations (for example, migrations1)
1. Detecting changes in your [Prisma schema](https://www.prisma.io/docs/reference/tools-and-interfaces/prisma-schema), which is the **source of truth** for your data model
2. Generating `.sql` migration files with changes (which you can [optionally modify]())
3. Applying the migration files to your database


```terminal
npx prisma migrate reset
```

1. Drops the database
1. Creates a new database with the same name
1. Applies all migrations

> **Note**: For a simple way to re-create data in your development database as often as needed, check out our [seeding guide](../../../guides/application-lifecycle/seed-database).

#### Advanced migrations

Modify SQL e.g. to preserve data - split 'name' into 'first name and last name' you need to write some custom SQL to preserve your data

#### Team development

Source control, sorting out issues

### Deployment

```terminal
npx prisma migrate deploy
```

Differences:

* No shadow db - only checks that migrations have been applied
* Risk of data loss - won't reset

Deployment overview guide
Examples of prisma migrate in deployment
Production troubleshooting

### Advisory locking

## Prisma Migrate artifacts

Prisma Migrate generates the following:

* A `prisma/migrations` folder with migration sub-folders and `.sql` files
* A `prisma/migrations/migration_lock.tml` file, which is used to detect if you have [attempted to change providers](prisma-migrate-limitations-issues#you-cannot-switch-database-providers)
* A `_prisma_migrations` table in the database

You should commit the entire `prisma/migrations` folder to source control, including `migration_lock.toml`.

## Advisory locking

Make sure multiple migrations do not run at the same time

* 10 second timeout (not configurable)
* Uses default advisory locking mechanism for the provider

  * Postgrse
  * Mysql
  * SQL server

## Commands

See [Prisma Migrate CLI reference](../../../reference/api-reference/command-reference#prisma-migrate) <span class="api"></span>.

In a development environment, 

```terminal
npx prisma migrate dev
```

In a production environment, or 

```terminal
npx prisma migrate deploy
```